!Plan
operations:
  
  - !hive {overwrite: true, table: INFORMATION.HOUSEHOLD_LKP, sqlQuery: "SELECT HOUSEHOLD_ID,HOUSEHOLD_NUM from staging.tb_household_n_int " }


  - !print {sqlQuery: "select  'LOADED HOUSEHOLD_LKP'" }
  
  - !hive {overwrite: true, table: INFORMATION.ENTERPRISE_CUSTOMER_LKP, sqlQuery: "SELECT 
ENTERPRISE_CUST_ID,
HOUSEHOLD_ID,
ECID,
GENDER_CD,
TENURE_YEARS_NUM,
BIRTH_YR_ID,
BIRTH_MONTH_ID,
MAILABLE_IND,
POSTCODE,
CUST_ACCT_STATUS
from staging.TB_ENTERPRISE_CUST_N_INT" }     

  - !print {sqlQuery: "select  'LOADED ENTERPRISE_CUSTOMER_LKP'" }
  
  - !hive {overwrite: true, table: INFORMATION.LOYALTY_ACCOUNT_LKP_AUTOMATION, sqlQuery: "SELECT 
ACCT_ID	 as LOYALTY_ACCOUNT_ID,
ACCT_NUM	 as LOYALTY_ACCOUNT_NUMBER,
START_TS	 as LOYALTY_ACCOUNT_CREATED_DATE,
END_TS	 as LOYALTY_ACCOUNT_EXPIRATION_DATE,
NULL	 as LOYALTY_ACCOUNT_NAME
from staging.TB_ACCT_N_INT_AUTOMATION  " }     


  - !print {sqlQuery: "select  'LOADED LOYALTY_ACCOUNT_LKP_AUTOMATION'" }


  - !hive {overwrite: true, table: INFORMATION.LOYALTY_ACCOUNT_CARD_DIM_AUTOMATION, sqlQuery: "SELECT
D.LOYALTY_ACCT_CARD_ID AS LOYALTY_ACCT_CARD_ID,
D.LOYALTY_ACCT_CARD_NUM AS LOYALTY_ACCT_CARD_NUM,
A.household_id	 as HOUSEHOLD_ID,
A.household_num	 as HOUSEHOLD_NUM,
B.ENTERPRISE_CUST_ID	 as ENTERPRISE_CUSTOMER_ID,
B.ECID	 as ECID,
B.BIRTH_MONTH_ID	 as BIRTH_MONTH,
B.BIRTH_YR_ID	 as BIRTH_YEAR,
B.GENDER_CD	 as GENDER,
B.POSTCODE	 as POSTCODE,
B.MAILABLE_IND	 as IS_MAILABLE_IND,
C.loyalty_acct_id	 as LOYALTY_ACCOUNT_ID,
NULL	 as ACCOUNT_NAME,
C.loyalty_acct_num	 as ACCOUNT_NUMBER,
C.START_TS	 as ACCOUNT_CREATED_DATE,
C.END_TS	 as ACCOUNT_EXPIRATION_DATE,
NULL	 as PRIMARY_CARD_HOLDER_IND,
NULL	 as HOUSEHOLD_IND,
NULL	 as LOYALTY_TIER_NAME,
NULL	 as VIC_IND,
B.MOBILE_APP_USER_IND	 as MOBILE_APP_USER_IND,
B.CAT_ACTIVE_IND	 as CAT_ACTIVE_IND,
B.JS_MAIN_ACTIVE_IND	 as JS_MAIN_ACTIVE_IND,
B.EMAILABLE_IND	 as NO_EMAIL_IND,
B.CUST_ACCT_STATUS as CUST_ACCT_STATUS from
staging.TB_ENTERPRISE_CUST_N_INT B 
left outer join staging.tb_household_n_int A 
on A.household_id = B.household_id 
join staging.TB_LOYALTY_ACCT_CARD_N_INT_AUTOMATION D
on D.ENTERPRISE_CUST_ID = B.ENTERPRISE_CUST_ID
 join staging.TB_LOYALTY_ACCT_N_INT_AUTOMATION c
on C.LOYALTY_ACCT_ID = D.LOYALTY_ACCT_ID" }     
  

  - !print {sqlQuery: "select  'LOADED LOYALTY_ACCOUNT_CARD_DIM_AUTOMATION'" }

  

  - !print {sqlQuery: "select  'LOADED SUCCESSFULLY' " }

